<table>
	<thead>
		<tr>
			<?php foreach (array_keys($table_data[0]) as $key): ?>
				<th>
					<a class="order-btn" href="?<?= http_build_query(['asc' =>1 - _get('asc'), 'table' => $table, 'order' => $key]) ?>">
						<?= $key ?>
						<?php if (_get('order') == $key): ?>
							<?= _get('asc') ? '↑' : '↓' ?>
						<?php endif ?>
					</a>
				</th>
			<?php endforeach ?>
		</tr>
	</thead>
	<tbody>
		<?php foreach ($table_data as $row): ?>
			<tr>
				<?php foreach ($row as $key => $value): ?>
					<td
						<?php if ($value && ($value[0] === '[' || $value[0] === '{') && ($o = json_decode($value))): ?>
							title="click to show pretty json"
							class="json-viewer"
							data-plain="<?= htmlspecialchars($value) ?>"
							data-is-pretty="0"
						<?php endif ?>
					>
					<?php if (isset($fkt[$table][$key])): $v = $fkt[$table][$key]; ?>
						<a href="?<?= http_build_query(['sql' => "SELECT * FROM `{$v[0]}` WHERE `$v[1]`=".Service('db')->quote($value)]).'LIMIT 1' ?>"><?= htmlspecialchars($value) ?></a>
					<?php else: ?>
						<?= htmlspecialchars($value) ?>
					<?php endif ?>
					</td>
				<?php endforeach ?>
				<td>
				<?php if (!Service('config')['readonly'] && $table): ?>
					<a href="edit?<?= http_build_query(['table' => $table, 'id' => $row[$pkey]]) ?>">edit</a>
					<a href="insert?<?= http_build_query(['table' => $table, 'id' => $row[$pkey]]) ?>">copy</a>
				<?php endif ?>
				</td>
			</tr>
		<?php endforeach ?>
	</tbody>
</table>
